{% extends "student/student_base.html" %}

{% block title %}My Profile{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white shadow-md rounded-lg overflow-hidden">
    <div class="p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">My Profile</h1>

        <div class="mt-8 border-t pt-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Recent Gate Passes</h2>
            {% if passes %}
                <div class="space-y-6">
                {% for pass in passes %}
                    <div class="border rounded-lg p-4 shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-700 mb-2 text-center">Hitam Gate Pass</h3>
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mr-4 text-center">
                                <img src="{{ student.image_url or url_for('static', filename='default-avatar.png') }}" class="w-32 h-40 object-cover rounded-md">
                                <p class="font-semibold mt-2">{{ student.name }}</p>
                                <p class="text-sm text-gray-600">{{ student.roll_number }}</p>
                            </div>
                            <div class="flex-grow">
                                <div class="mt-2 space-y-2">
                                    <p><strong>Attendance:</strong> {{ pass.attendance_percentage | default('N/A') }}%</p>
                                    <p><strong>Year and Branch:</strong> {{ student.academic_year}} {{ student.branch }}</p>
                                    <p><strong>Time:</strong> From: {{ pass.from_time }} To: {{ pass.to_time }}</p>
                                    <p><strong>Reason:</strong> {{ pass.reason }}</p>
                                    <p><strong>Type:</strong> {{ pass.pass_type | default('Normal') }}</p>
                                    <p><strong>Status:</strong> <span class="font-bold 
                                            {% if pass.status == 'approved' %} text-green-500
                                            {% elif pass.status == 'rejected' %} text-red-500
                                            {% else %} text-yellow-500 {% endif %}">
                                            {{ pass.status | capitalize }}
                                            </span></p>
                                    <p><strong>Date:</strong> {{ pass.date.strftime('%B %d, %Y') if pass.date }}</p>
                                    <p><strong>Gatepass ID:</strong> {{ pass.id }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
                </div>
            {% else %}
                <p>No gate passes found.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
